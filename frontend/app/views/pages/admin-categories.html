<!-- Admin Categories Management Page -->
<div class="admin-categories-page" ng-controller="AdminCategoriesController as vm">
    <!-- Page Header -->
    <div class="page-header">
        <div class="container-fluid">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="page-title">
                        <i class="fa fa-tags"></i> Category Management
                    </h1>
                    <p class="page-subtitle">Organize your church content into categories</p>
                </div>
                <div class="header-right">
                    <button class="btn btn-primary" ng-click="vm.openAddModal()">
                        <i class="fa fa-plus"></i> Add Category
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Categories Section -->
    <div class="categories-section">
        <div class="container-fluid">
            <!-- Loading State -->
            <div class="loading-state" ng-if="vm.isLoading">
                <div class="loading-container">
                    <i class="fa fa-spinner fa-spin fa-2x"></i>
                    <p>Loading categories...</p>
                </div>
            </div>

            <!-- Categories Grid -->
            <div class="categories-grid" ng-if="!vm.isLoading && vm.sortedCategories().length > 0">
                <div class="category-card" ng-repeat="category in vm.sortedCategories()">
                    <div class="category-header">
                        <div class="category-icon">
                            <i class="fa {{vm.getCategoryIcon(category)}} fa-2x"></i>
                        </div>
                        <div class="category-actions">
                            <button class="btn btn-sm btn-outline-secondary"
                                    ng-click="vm.moveUp(category)"
                                    ng-disabled="$index === 0"
                                    title="Move up">
                                <i class="fa fa-arrow-up"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-secondary"
                                    ng-click="vm.moveDown(category)"
                                    ng-disabled="$index === vm.sortedCategories().length - 1"
                                    title="Move down">
                                <i class="fa fa-arrow-down"></i>
                            </button>
                        </div>
                    </div>

                    <div class="category-content">
                        <h3 class="category-name">{{category.name}}</h3>
                        <p class="category-slug">{{category.slug}}</p>
                        <p class="category-description" ng-if="category.description">{{category.description}}</p>

                        <div class="category-stats">
                            <div class="stat-item">
                                <i class="fa fa-video-camera"></i>
                                {{vm.getVideoCount(category)}} videos
                            </div>
                            <div class="stat-item">
                                <span class="status-badge" ng-class="category.is_active ? 'active' : 'inactive'">
                                    {{category.is_active ? 'Active' : 'Inactive'}}
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="category-footer">
                        <div class="category-order">
                            Order: {{category.sort_order || 0}}
                        </div>
                        <div class="category-buttons">
                            <button class="btn btn-sm btn-outline-primary"
                                    ng-click="vm.openEditModal(category)"
                                    title="Edit category">
                                <i class="fa fa-edit"></i> Edit
                            </button>
                            <button class="btn btn-sm"
                                    ng-class="category.is_active ? 'btn-outline-warning' : 'btn-outline-success'"
                                    ng-click="vm.toggleStatus(category)"
                                    title="{{category.is_active ? 'Deactivate' : 'Activate'}} category">
                                <i class="fa" ng-class="category.is_active ? 'fa-eye-slash' : 'fa-eye'"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger"
                                    ng-click="vm.deleteCategory(category)"
                                    title="Delete category">
                                <i class="fa fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div class="empty-state" ng-if="!vm.isLoading && vm.sortedCategories().length === 0">
                <div class="empty-container">
                    <i class="fa fa-tags fa-3x text-muted"></i>
                    <h3>No categories found</h3>
                    <p>Get started by creating your first content category.</p>
                    <button class="btn btn-primary" ng-click="vm.openAddModal()">
                        <i class="fa fa-plus"></i> Create First Category
                    </button>
                </div>
            </div>

            <!-- Help Section -->
            <div class="help-section" ng-if="!vm.isLoading && vm.sortedCategories().length > 0">
                <div class="help-card">
                    <h4><i class="fa fa-info-circle"></i> Category Management Tips</h4>
                    <ul>
                        <li><strong>Sort Order:</strong> Use the up/down arrows to reorder categories on your homepage</li>
                        <li><strong>Slugs:</strong> URL-friendly identifiers automatically generated from category names</li>
                        <li><strong>Status:</strong> Inactive categories won't appear on the public site</li>
                        <li><strong>Church Content:</strong> Create categories like "Sermons", "Worship", "Youth", "Bible Study"</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div class="modal fade" id="addCategoryModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" ng-click="vm.closeAddModal()">
                        <span>&times;</span>
                    </button>
                    <h4 class="modal-title">
                        <i class="fa fa-plus"></i> Add New Category
                    </h4>
                </div>
                <form ng-submit="vm.addCategory()">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="category_name">Category Name *</label>
                                    <input type="text"
                                           class="form-control"
                                           id="category_name"
                                           ng-model="vm.newCategory.name"
                                           ng-change="vm.onNameChange(vm.newCategory)"
                                           placeholder="e.g., Sermons, Worship, Youth"
                                           required>
                                    <small class="help-block">
                                        Display name for the category
                                    </small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="category_slug">URL Slug *</label>
                                    <input type="text"
                                           class="form-control"
                                           id="category_slug"
                                           ng-model="vm.newCategory.slug"
                                           placeholder="e.g., sermons, worship, youth"
                                           required>
                                    <small class="help-block">
                                        Auto-generated from name (URL-friendly)
                                    </small>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="category_description">Description</label>
                            <textarea class="form-control"
                                      id="category_description"
                                      ng-model="vm.newCategory.description"
                                      rows="3"
                                      placeholder="Brief description of this category (optional)"></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="category_thumbnail">Thumbnail URL</label>
                                    <input type="url"
                                           class="form-control"
                                           id="category_thumbnail"
                                           ng-model="vm.newCategory.thumbnail_url"
                                           placeholder="https://example.com/image.jpg">
                                    <small class="help-block">
                                        Optional image URL for category display
                                    </small>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="sort_order">Sort Order</label>
                                    <input type="number"
                                           class="form-control"
                                           id="sort_order"
                                           ng-model="vm.newCategory.sort_order"
                                           min="0"
                                           placeholder="0">
                                    <small class="help-block">
                                        Lower numbers appear first (0 = highest priority)
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="vm.closeAddModal()">
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fa fa-plus"></i> Add Category
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit Category Modal -->
    <div class="modal fade" id="editCategoryModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" ng-click="vm.closeEditModal()">
                        <span>&times;</span>
                    </button>
                    <h4 class="modal-title">
                        <i class="fa fa-edit"></i> Edit Category
                    </h4>
                </div>
                <form ng-submit="vm.updateCategory()" ng-if="vm.editingCategory">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="edit_category_name">Category Name</label>
                                    <input type="text"
                                           class="form-control"
                                           id="edit_category_name"
                                           ng-model="vm.editingCategory.name"
                                           ng-change="vm.onNameChange(vm.editingCategory)"
                                           required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="edit_category_slug">URL Slug</label>
                                    <input type="text"
                                           class="form-control"
                                           id="edit_category_slug"
                                           ng-model="vm.editingCategory.slug"
                                           required>
                                    <small class="help-block">
                                        Changing slug may break existing links
                                    </small>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="edit_category_description">Description</label>
                            <textarea class="form-control"
                                      id="edit_category_description"
                                      ng-model="vm.editingCategory.description"
                                      rows="3"></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="edit_category_thumbnail">Thumbnail URL</label>
                                    <input type="url"
                                           class="form-control"
                                           id="edit_category_thumbnail"
                                           ng-model="vm.editingCategory.thumbnail_url">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="edit_sort_order">Sort Order</label>
                                    <input type="number"
                                           class="form-control"
                                           id="edit_sort_order"
                                           ng-model="vm.editingCategory.sort_order"
                                           min="0">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" ng-model="vm.editingCategory.is_active">
                                    Category is active and visible to users
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="vm.closeEditModal()">
                            Cancel
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fa fa-save"></i> Update Category
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
/* Admin Categories Page Styles */
.admin-categories-page {
    min-height: 100vh;
    background-color: #f8f9fa;
}

/* Page Header */
.page-header {
    background: linear-gradient(135deg, #6a0dad 0%, #4c1d95 100%);
    color: white;
    padding: 20px 0;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.page-title {
    margin: 0 0 5px 0;
    font-size: 24px;
    font-weight: 700;
}

.page-subtitle {
    margin: 0;
    opacity: 0.8;
}

.header-right {
    display: flex;
    gap: 10px;
}

/* Categories Grid */
.categories-section {
    padding: 30px 0;
}

.categories-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
}

.category-card {
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    overflow: hidden;
    transition: all 0.3s ease;
}

.category-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}

.category-header {
    background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.category-icon {
    opacity: 0.9;
}

.category-actions {
    display: flex;
    gap: 5px;
}

.category-actions .btn {
    color: white;
    border-color: rgba(255,255,255,0.3);
}

.category-actions .btn:hover {
    background: rgba(255,255,255,0.2);
    border-color: rgba(255,255,255,0.5);
}

.category-actions .btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.category-content {
    padding: 20px;
}

.category-name {
    font-size: 18px;
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 5px;
}

.category-slug {
    font-family: monospace;
    font-size: 14px;
    color: #666;
    margin-bottom: 10px;
}

.category-description {
    color: #666;
    line-height: 1.5;
    margin-bottom: 15px;
}

.category-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
    color: #666;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 5px;
}

.status-badge {
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
}

.status-badge.active {
    background: #d4edda;
    color: #155724;
}

.status-badge.inactive {
    background: #f8d7da;
    color: #721c24;
}

.category-footer {
    padding: 15px 20px;
    background: #f8f9fa;
    border-top: 1px solid #e9ecef;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.category-order {
    font-size: 12px;
    color: #666;
    font-weight: 600;
}

.category-buttons {
    display: flex;
    gap: 5px;
}

/* Loading and Empty States */
.loading-state, .empty-state {
    text-align: center;
    padding: 80px 20px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.loading-container, .empty-container {
    max-width: 400px;
    margin: 0 auto;
}

.empty-container i {
    margin-bottom: 20px;
    opacity: 0.5;
}

/* Help Section */
.help-section {
    margin-top: 40px;
}

.help-card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    padding: 25px;
}

.help-card h4 {
    color: #2c3e50;
    margin-bottom: 15px;
    font-size: 16px;
}

.help-card ul {
    padding-left: 20px;
}

.help-card li {
    margin-bottom: 8px;
    color: #666;
    line-height: 1.5;
}

/* Modal Styles */
.modal-content {
    border-radius: 8px;
    border: none;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

.modal-header {
    background: #f8f9fa;
    border-bottom: 1px solid #dee2e6;
    border-radius: 8px 8px 0 0;
}

.modal-title {
    color: #2c3e50;
    font-weight: 600;
}

.modal-body {
    padding: 25px;
}

.modal-footer {
    border-top: 1px solid #dee2e6;
    padding: 15px 25px;
}

/* Form Styles */
.form-control {
    border-radius: 6px;
    border: 1px solid #ddd;
    padding: 8px 12px;
    font-size: 14px;
}

.form-control:focus {
    border-color: #3498db;
    box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.25);
}

.help-block {
    color: #666;
    font-size: 12px;
    margin-top: 5px;
}

/* Responsive Design */
@media (max-width: 768px) {
    .header-content {
        flex-direction: column;
        text-align: center;
        gap: 15px;
    }

    .categories-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    }

    .category-header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
    }

    .category-actions {
        justify-content: center;
    }

    .category-footer {
        flex-direction: column;
        gap: 10px;
        text-align: center;
    }

    .category-buttons {
        justify-content: center;
        flex-wrap: wrap;
    }

    .modal-dialog {
        margin: 10px;
        width: auto;
    }
}

@media (max-width: 480px) {
    .page-title {
        font-size: 20px;
    }

    .header-right {
        flex-direction: column;
        width: 100%;
    }

    .header-right .btn {
        width: 100%;
        margin-bottom: 5px;
    }

    .categories-grid {
        grid-template-columns: 1fr;
    }

    .category-stats {
        flex-direction: column;
        gap: 10px;
        align-items: center;
    }

    .help-card ul {
        padding-left: 15px;
    }
}
</style>